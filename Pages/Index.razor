@page "/"
@using OtherPeopleRecordsWeb.Data
@inject ApplicationDbContext DbContext
@inject IJSRuntime JS
@using Microsoft.EntityFrameworkCore
@inject NavigationManager nav
@inject Global global

<PageTitle>OtherPeopleRecords</PageTitle>

<MudContainer Class="d-flex flex-column justify-center align-center ma-0 pa-0 pt-5" Style=" width:100%; height:auto; margin-top:40px!important; max-width: 90%">
	<OTPHeader></OTPHeader>
    <MudButton Style="margin-bottom: 5vw; margin-top: 2vw;" OnClick="@(()=>ScrollToBottom())" IconClass="IconSizeLarge" IconSize="Size.Large" Class="d-flex justify-end rounded-lg align-end" Variant="Variant.Filled" EndIcon="@Icons.Material.Filled.ArrowDownward" Color="Color.Tertiary"><MudText Typo="Typo.button">Ultimas Novedades</MudText></MudButton>

    <MudGrid id="scrollTarget" Style="width:95%;" Class="align-center justify-center ma-0 pa-0">
        @foreach (Card card in _cards.Where(c => c.cardType == CardType.Song || c.cardType == CardType.Video).OrderByDescending(c => c.date))
        {
            <OTPCard card="card" FromLeft="direction" />
            direction = !direction;
        }
	</MudGrid>
</MudContainer>

@code {
    private bool direction = true;
    private List<Card> _cards = new();

    protected override async Task OnInitializedAsync()
    {
        _cards = DbContext.Cards.ToList();
    }

    private async Task ScrollToBottom()
    {
        await JS.InvokeAsync<object>("scrollToElement", "scrollTarget");
    }
}
